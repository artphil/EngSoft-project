<!DOCTYPE html>
<html lang="pt-br">

<head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- essas 3 meta tags precisam estar logo após a tag head do documento, qualquer outra meta tag pode ser declarada abaixo destas -->
        <title>
                RePouso - Quartos
        </title>

        <!-- link para o arquivo CSS do Bootstrap -->
        <link href="css/bootstrap.css" rel="stylesheet">

        <!-- link para o arquivo CSS do projeto -->
        <link href="css-agl/agl.css" rel="stylesheet">

        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

</head>


<body onload="myRequestRooms()">
        <div class="container">
                <div class="row">
                        <div class="col-lg-12">
                                <center>
                                        <h1>
                                                Quartos
                                        </h1>
                                </center>
                        </div>
                </div>
                <div class="row">
                        <div class="col-md-12">
                                <a class="btn btn-default" href="index.html" role="button">
                                        Voltar
                                </a>
                        </div>
                </div>

                <div class="row">
                        <div class="col-lg-12">
                                <h3>
                                        Gerencia de quartos
                                </h3>
                        </div>
                </div>


                <!-- <button type="button" onclick="myRequestRooms()" class="btn btn-default">
                Atualiza
        </button> -->

                <div class="row">
                        <div class="col-lg-3 col-sm-12">
                                <div id="rooms"></div>
                                <img class="img-bar" src="img/cor_quarto.svg" alt="Responsive image"></img>
                        </div>
                        <div class="col-lg-9 col-sm-12">
                                <div class="input-group">
                                        <span class="input-group-addon">Quarto</span>
                                        <input type="text" class="form-control" id="qrt-num" placeholder="Quarto" aria-describedby="qrt-num">
                                </div>
                                <div class="input-group botoes">
                                        <select type="select" id="qrt-stat" class="form-control">
                                        <option value="0">Estado</option>
                                        <option value="1">Disponivel</option>
                                        <option value="2">Reservado</option>
                                        <option value="3">Ocupado</option>
                                        <option value="4">Indisponivel</option>
                                </select>
                                </div>


                                <div class="form-group">
                                        <span class="input-group-addon">Descrição</span>
                                        <textarea type="text" class="form-control" id="qrt-desc" rows="6" textAreaContent="ooooo"></textarea>
                                </div>
                                <button type="button" class="btn btn-default botoes">
                                        Alterar
                                </button>
                        </div>
                </div>
        </div>

</body>

<script type="text/javascript">
        var myRequestRooms = function() {
                console.log("oi estou aqui");

                var roomsContainer = document.getElementById('rooms');

                var impressor = function(jsonData) {
                        console.log(jsonData);

                        for (var key of Object.keys(jsonData)) {
                                var buttonElement = document.createElement('button');
                                buttonElement.innerHTML = key;
                                buttonElement.classList.add("btn");
                                buttonElement.classList.add("botao");
                                buttonElement.setAttribute("onclick", "fillRooms(" + key + ");");
                                var status;
                                if (jsonData[key]['status'] == "vacant") {
                                        status = "btn-default";
                                } else if (jsonData[key]['status'] == "occupied") {
                                        status = "btn-warning";
                                } else if (jsonData[key]['status'] == "reserved") {
                                        status = "btn-primary";
                                } else if (jsonData[key]['status'] == "unusable") {
                                        status = "btn-danger";
                                }
                                buttonElement.classList.add(status);
                                roomsContainer.appendChild(buttonElement);
                        }
                };
                console.log("oi estou aqui");

                window.fetch('http://127.0.0.1:80/listRooms')
                        .then(function(response) {
                                console.log("GRRRUUUAAARRRRRRR");

                                return response.json();
                        })
                        .then(impressor)
                        .catch(function(err) {
                                console.log("Oops, something went wrong!", err);
                        });
        };
</script>

<script type="text/javascript">
        var fillRooms = function(idRooms) {
                console.log("oi estou aqui");

                var roomsNumero = document.getElementById('qrt-num');
                var roomsDesc = document.getElementById('qrt-desc');
                var roomsStat = document.getElementById('qrt-stat');

                var impressor = function(jsonData) {
                        var numero = jsonData[idRooms]['id']

                        roomsNumero.setAttribute("value", "" + idRooms + "");
                        roomsDesc.value = "Ainda não implementamos a descrição do quarto";

                        if (jsonData[idRooms]['status'] == "vacant") {
                                roomsStat.selectedIndex = 1;
                        } else if (jsonData[idRooms]['status'] == "occupied") {
                                roomsStat.selectedIndex = 3;
                        } else if (jsonData[idRooms]['status'] == "reserved") {
                                roomsStat.selectedIndex = 2;
                        } else if (jsonData[idRooms]['status'] == "unusable") {
                                roomsStat.selectedIndex = 4;
                        }
                }

                window.fetch('http://127.0.0.1:80/listRooms')
                        .then(function(response) {
                                return response.json();
                        })
                        .then(impressor)
                        .catch(function(err) {
                                console.log("Oops, something went wrong!", err);
                        });
        };
</script>

<footer class="navbar-fixed-bottom">
        <center>
                <h5>
                        RePouSo - AGL Software - Copyrigth 2017
                </h5>
        </center>
</footer>

</html>
